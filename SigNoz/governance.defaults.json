{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "TansuCloud SigNoz Governance Defaults",
  "description": "Deployment-wide observability governance defaults for SigNoz/ClickHouse. Applied via VS Code tasks using dev/tools/signoz-apply-governance.ps1. Values are safe defaults for Development; adjust for Production in your ops overlays.",
  "type": "object",
  "properties": {
    "retentionDays": {
      "type": "object",
      "description": "Retention in days for each signal. In dev, keep short to save disk; in prod, set per policy.",
      "properties": {
        "traces": { "type": "integer", "minimum": 1, "default": 7 },
        "logs": { "type": "integer", "minimum": 1, "default": 7 },
        "metrics": { "type": "integer", "minimum": 1, "default": 14 }
      },
      "required": ["traces", "logs", "metrics"]
    },
    "sampling": {
      "type": "object",
      "description": "Head-based sampling ratios. For dev, prefer 1.0 (no sampling). In prod, tune per SLO and cost.",
      "properties": {
        "traceRatio": { "type": "number", "minimum": 0, "maximum": 1, "default": 1.0 }
      },
      "required": ["traceRatio"]
    },
    "alertSLOs": {
      "type": "array",
      "description": "Curated alert SLO templates to seed in SigNoz. Implementers may translate these into SigNoz alert rules.",
      "items": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "description": { "type": "string" },
          "service": { "type": "string" },
          "kind": { "type": "string", "enum": ["latency_p95", "error_rate", "availability"] },
          "windowMinutes": { "type": "integer", "minimum": 1 },
          "threshold": { "type": "number", "minimum": 0 },
          "comparison": { "type": "string", "enum": [">", ">=", "<", "<="] }
        },
        "required": ["id", "description", "service", "kind", "windowMinutes", "threshold", "comparison"]
      },
      "default": [
        {
          "id": "gateway_error_rate",
          "description": "Gateway 5xx rate over 5m should stay < 1%",
          "service": "tansu.gateway",
          "kind": "error_rate",
          "windowMinutes": 5,
          "threshold": 0.01,
          "comparison": "<"
        },
        {
          "id": "identity_latency",
          "description": "Identity p95 latency over 5m should be < 300ms",
          "service": "tansu.identity",
          "kind": "latency_p95",
          "windowMinutes": 5,
          "threshold": 300,
          "comparison": "<"
        }
      ]
    }
  },
  "required": ["retentionDays", "sampling", "alertSLOs"]
}
